<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DORA Compliance Gap Analysis Matrix</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .stats-bar {
            display: flex;
            background: #f8f9fa;
            padding: 20px;
            justify-content: space-around;
            border-bottom: 2px solid #e9ecef;
        }

        .stat {
            text-align: center;
            padding: 10px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .compliant { color: #28a745; }
        .gap { color: #dc3545; }
        .progress { color: #ffc107; }

        .filters {
            padding: 20px;
            background: #f8f9fa;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        select, input {
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .table-container {
            overflow-x: auto;
            max-height: 70vh;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        thead {
            background: linear-gradient(135deg, #495057, #6c757d);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
            border-right: 1px solid #e9ecef;
            vertical-align: top;
            line-height: 1.4;
        }

        tr:hover {
            background-color: rgba(102, 126, 234, 0.05);
            transform: scale(1.01);
            transition: all 0.2s ease;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
            min-width: 80px;
            text-align: center;
        }

        .status-compliant { background: #d4edda; color: #155724; }
        .status-gap { background: #f8d7da; color: #721c24; }
        .status-progress { background: #fff3cd; color: #856404; }

        .priority {
            font-weight: bold;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        .priority-high { background: #ffebee; color: #c62828; }
        .priority-medium { background: #fff8e1; color: #f57c00; }
        .priority-low { background: #e8f5e8; color: #2e7d2e; }

        .article-cell {
            max-width: 200px;
            word-wrap: break-word;
            font-weight: 500;
        }

        .requirement-cell {
            max-width: 300px;
            word-wrap: break-word;
        }

        .action-cell {
            max-width: 250px;
            word-wrap: break-word;
        }

        .framework-tag {
            background: #e3f2fd;
            color: #1565c0;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 10px;
            margin: 2px;
            display: inline-block;
        }

        .export-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .stats-bar { flex-direction: column; gap: 10px; }
            .filters { flex-direction: column; align-items: stretch; }
            th, td { padding: 8px; font-size: 12px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>DORA Compliance Gap Analysis Matrix</h1>
            <p>Comprehensive assessment of regulatory compliance status and remediation roadmap</p>
        </div>

        <div class="stats-bar">
            <div class="stat">
                <div class="stat-number compliant" id="compliantCount">0</div>
                <div class="stat-label">Compliant</div>
            </div>
            <div class="stat">
                <div class="stat-number gap" id="gapCount">0</div>
                <div class="stat-label">Gaps Identified</div>
            </div>
            <div class="stat">
                <div class="stat-number progress" id="progressCount">0</div>
                <div class="stat-label">In Progress</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">Total Requirements</div>
            </div>
        </div>

        <div class="filters">
            <div class="filter-group">
                <label>Article:</label>
                <select id="articleFilter">
                    <option value="">All Articles</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Gap Status:</label>
                <select id="gapFilter">
                    <option value="">All Status</option>
                    <option value="Yes">Has Gap</option>
                    <option value="No">No Gap</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Framework:</label>
                <select id="frameworkFilter">
                    <option value="">All Frameworks</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Search:</label>
                <input type="text" id="searchInput" placeholder="Search requirements...">
            </div>
            <button class="export-btn" onclick="exportToCSV()">Export CSV</button>
        </div>

        <div class="table-container">
            <table id="gapMatrix">
                <thead>
                    <tr>
                        <th>Article</th>
                        <th>Subsection</th>
                        <th>Requirement</th>
                        <th>Gap Status</th>
                        <th>Priority</th>
                        <th>Remediation Action</th>
                        <th>Current Status</th>
                        <th>Framework</th>
                        <th>Rationale</th>
                    </tr>
                </thead>
                <tbody id="matrixBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Parse CSV data and create matrix
        const gapData = [
            {
                article: "Article 6: Due Diligence",
                subsection: "1(b)",
                requirement: "Have you implemented ICT security measures aligned with industry best practices (e.g. ISO/IEC 27001, NIST, ENISA guidance)",
                hasGap: "No",
                action: "N/A",
                status: "N/A",
                rationale: "The organization has been audited by an external company to ascertain compliance with ISO/IEC 27001",
                framework: "ISO/IEC 27001"
            },
            {
                article: "Article 1: Overall risk profile and complexity",
                subsection: "1",
                requirement: "Do you conduct regular vulnerability assessments and penetration testing?",
                hasGap: "Yes",
                action: "will carry out vulnerability checks and external penetration testing once a year, starting in 2025. Any issues found will be shared within 10 working days and fixed based on agreed timelines",
                status: "In Progress (tracked by internal manager)",
                rationale: "Vulnerability assessments are being conducted on demand more on this below. Penetration testing is performed once a year",
                framework: "ISO/IEC 27001"
            },
            {
                article: "Article 36: ICT Security Testing",
                subsection: "Article 36(3)",
                requirement: "Do you monitor and evaluate the results of security tests conducted on your ICT systems and security measures?",
                hasGap: "No",
                action: "N/A",
                status: "N/A",
                rationale: "Qualys Web Application Scanning (WAS) and Qualys Vulnerability Management, Detection, and Response (VMDR) are regularly run against the relevant environments and applications.",
                framework: "ISO/IEC 27001"
            },
            {
                article: "Article 36: ICT Security Testing",
                subsection: "Article 36(3)",
                requirement: "When vulnerabilities or weaknesses are identified, do you update your security measures without undue delay, especially for critical or important systems?",
                hasGap: "No",
                action: "N/A",
                status: "N/A",
                rationale: "Refinement meetings, sprint review meetings, support meetings, sprint retrospective nd planning meetings are held weekly where necessary to ensure bugs/vulnerabilities identified are discussed and put into Jira swimlane to be addressed as efficiently as possible",
                framework: "ISO/IEC 27001"
            },
            {
                article: "Article 36: ICT Security Testing",
                subsection: "Implied from Article 36(2) & (3)",
                requirement: "Do you use appropriate methods and tools for ICT security testing, such as vulnerability assessments, penetration testing, or threat-led penetration testing (TLPT)?",
                hasGap: "Yes",
                action: "While the provider does not conduct penetration testing directly, clients regularly perform penetration testing against the software in accordance with their own security policies.",
                status: "Tracked in Jira when vulnerability scan is run/penetration testing is conducted against Software X",
                rationale: "The organization uses Qualys and Microsoft Defender XDR",
                framework: "ISO 27001"
            },
            {
                article: "Article 36: ICT Security Testing",
                subsection: "Art. 36",
                requirement: "Are the testing methods aligned with leading industry practices?",
                hasGap: "No",
                action: "N/A",
                status: "N/A",
                rationale: "Qualys VMDR vulnerability tests and WAS scans are all threat led tests because they use CVE signatures. Quality Assurance ensures well orchestrated functionality",
                framework: "ISO/IEC 27001"
            },
            {
                article: "Article 10: Vulnerability and Patch Management",
                subsection: "Art. 10(1)",
                requirement: "Have you developed, documented, and implemented vulnerability management procedures as part of your ICT security policies, procedures, protocols, and tools?",
                hasGap: "Yes",
                action: "Vulnerability scans conducted in Qualys generate reports that are attached to Jira tickets, detailing identified issues. However, this approach is not yet comprehensive.",
                status: "is going through stages of adjusments",
                rationale: "A comprehensive vulnerability dictionary is currently being curated to centralize and enhance our knowledge of identified vulnerabilities and their associated details.",
                framework: "ISO/IEC 27001"
            },
            {
                article: "Article 10: Vulnerability and Patch Management",
                subsection: "Art. 10(2)(b)",
                requirement: "Are vulnerabilities assessed weekly for ICT assets supporting critical or important functions?",
                hasGap: "Yes",
                action: "Vulnerability checked currently are performed on demand and are not automated, this will be altered to run automatic WAS and VMDR scans weekly",
                status: "Tracked by internal member of staff",
                rationale: "A WAS and VMDR scan will be setup to be run against the QA virtual machine weekly to ensure vulnerabilities are revealed",
                framework: "ISO/IEC 27001"
            },
            {
                article: "Article 11: Data and System Security",
                subsection: "Art. 11(2)(b)",
                requirement: "Have you identified a secure configuration baseline for all ICT assets that minimizes exposure to cyber threats?",
                hasGap: "Yes",
                action: "User Acceptance Testing server and production environment all meet the security baseline, however some of that configuration is missing from the quality assurance server where software x is hosted for testing.",
                status: "This gap has been deemed acceptable within the company's defined risk appetite, and no immediate remediation actions will be taken.",
                rationale: "Typical hardening policies or guidelines would be in line with detections we see in VMDR (in Qualys)",
                framework: "ISO/IEC 27005"
            },
            {
                article: "Article 16: ICT Systems Acquisition, Development, and Maintenance",
                subsection: "Article 16(3)",
                requirement: "Does the procedure include performing source code reviews covering both static and dynamic testing?",
                hasGap: "Yes",
                action: "Qualys Web Application Scanning conducts dynamic application security testing on Software X during runtime. Currently, only manual code reviews are performed, indicating an opportunity to enhance the process by incorporating a static code analysis tool like SonarCloud.",
                status: "Is being overseen by a member of staff",
                rationale: "Currently, dynamic security testing is performed on Software X using Qualys Web Application Scanning to identify vulnerabilities during runtime.",
                framework: "DevSecOps, OWASP Software Assurance Maturity Model (SAMM)"
            },
            {
                article: "Article 28: Governance and Organisation",
                subsection: "Art. 28(2)(h) + (2)(e)",
                requirement: "Do your staff: Receive ICT risk training proportionate to their roles? Stay current on cybersecurity, resilience practices, and regulatory expectations?",
                hasGap: "Yes",
                action: "We are using two education tools Microsoft Defender - Attack Simulation Training This is automated and works by rating users risky behavior. Pluralsight - We will start rolling out specific courses for staff based on their role.",
                status: "In Progress (tracked by internal manager)",
                rationale: "An auditable training program ensures staff receive role-based, up-to-date instruction, supporting compliance with cybersecurity and regulatory requirements",
                framework: "ISO/IEC 27001"
            },
            {
                article: "Article 34: ICT Operations Security",
                subsection: "Art. 34(d), (h), (i)",
                requirement: "Are vulnerability scans conducted regularly and updated to address emerging threats?",
                hasGap: "Yes",
                action: "As previously noted, vulnerability scans are currently performed on an ad hoc basis and lack a consistent schedule.",
                status: "The implementation of automatic scanning process is currently being implemented by a member of staff",
                rationale: "Currently, vulnerability scans are conducted on an ad hoc basis without a fixed schedule; establishing a consistent scanning routine will enhance threat detection and improve overall security posture.",
                framework: "ISO/IEC 27001"
            }
        ];

        function getPriority(hasGap, status) {
            if (hasGap === "No") return "low";
            if (status && status.includes("In Progress")) return "medium";
            if (hasGap === "Yes") return "high";
            return "medium";
        }

        function getStatusBadge(hasGap, status) {
            if (hasGap === "No") return "status-compliant";
            if (status && (status.includes("In Progress") || status.includes("tracked"))) return "status-progress";
            return "status-gap";
        }

        function getStatusText(hasGap, status) {
            if (hasGap === "No") return "Compliant";
            if (status && (status.includes("In Progress") || status.includes("tracked"))) return "In Progress";
            return "Gap";
        }

        function populateMatrix() {
            const tbody = document.getElementById('matrixBody');
            tbody.innerHTML = '';

            gapData.forEach(item => {
                const row = document.createElement('tr');
                const priority = getPriority(item.hasGap, item.status);
                const statusClass = getStatusBadge(item.hasGap, item.status);
                const statusText = getStatusText(item.hasGap, item.status);

                row.innerHTML = `
                    <td class="article-cell">${item.article}</td>
                    <td>${item.subsection}</td>
                    <td class="requirement-cell">${item.requirement}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td><span class="priority priority-${priority}">${priority.toUpperCase()}</span></td>
                    <td class="action-cell">${item.action}</td>
                    <td>${item.status}</td>
                    <td><span class="framework-tag">${item.framework}</span></td>
                    <td>${item.rationale}</td>
                `;
                tbody.appendChild(row);
            });

            updateStats();
            populateFilters();
        }

        function updateStats() {
            const compliant = gapData.filter(item => item.hasGap === "No").length;
            const gaps = gapData.filter(item => item.hasGap === "Yes").length;
            const progress = gapData.filter(item => item.status && (item.status.includes("In Progress") || item.status.includes("tracked"))).length;

            document.getElementById('compliantCount').textContent = compliant;
            document.getElementById('gapCount').textContent = gaps;
            document.getElementById('progressCount').textContent = progress;
            document.getElementById('totalCount').textContent = gapData.length;
        }

        function populateFilters() {
            const articleFilter = document.getElementById('articleFilter');
            const frameworkFilter = document.getElementById('frameworkFilter');

            const articles = [...new Set(gapData.map(item => item.article))].sort();
            const frameworks = [...new Set(gapData.map(item => item.framework))].sort();

            articles.forEach(article => {
                const option = document.createElement('option');
                option.value = article;
                option.textContent = article;
                articleFilter.appendChild(option);
            });

            frameworks.forEach(framework => {
                const option = document.createElement('option');
                option.value = framework;
                option.textContent = framework;
                frameworkFilter.appendChild(option);
            });
        }

        function filterMatrix() {
            const articleFilter = document.getElementById('articleFilter').value;
            const gapFilter = document.getElementById('gapFilter').value;
            const frameworkFilter = document.getElementById('frameworkFilter').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const rows = document.querySelectorAll('#matrixBody tr');

            rows.forEach(row => {
                const cells = row.cells;
                const article = cells[0].textContent;
                const hasGap = gapData.find(item => item.article === article)?.hasGap || "";
                const framework = cells[7].textContent;
                const requirement = cells[2].textContent.toLowerCase();

                const matchesArticle = !articleFilter || article === articleFilter;
                const matchesGap = !gapFilter || hasGap === gapFilter;
                const matchesFramework = !frameworkFilter || framework.includes(frameworkFilter);
                const matchesSearch = !searchTerm || requirement.includes(searchTerm);

                if (matchesArticle && matchesGap && matchesFramework && matchesSearch) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        function exportToCSV() {
            const headers = ['Article', 'Subsection', 'Requirement', 'Gap Status', 'Priority', 'Action', 'Status', 'Framework', 'Rationale'];
            const csvContent = [
                headers.join(','),
                ...gapData.map(item => [
                    `"${item.article}"`,
                    `"${item.subsection}"`,
                    `"${item.requirement}"`,
                    `"${item.hasGap}"`,
                    `"${getPriority(item.hasGap, item.status)}"`,
                    `"${item.action}"`,
                    `"${item.status}"`,
                    `"${item.framework}"`,
                    `"${item.rationale}"`
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'DORA_Gap_Analysis_Matrix.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Event listeners
        document.getElementById('articleFilter').addEventListener('change', filterMatrix);
        document.getElementById('gapFilter').addEventListener('change', filterMatrix);
        document.getElementById('frameworkFilter').addEventListener('change', filterMatrix);
        document.getElementById('searchInput').addEventListener('input', filterMatrix);

        // Initialize matrix
        populateMatrix();
    </script>
</body>
</html>